+++
title = "Testing for PowerShell Remoting: Test-PsRemoting"
date = 2009-12-23T11:51:00Z
updated = 2009-12-23T12:09:51Z
blogimport = true 
[author]
	name = "Paul Cassidy"
	uri = "https://plus.google.com/112112394037667071918"
+++

<a href="http://www.leeholmes.com/blog/TestingForPowerShellRemotingTestPsRemoting.aspx">Testing for PowerShell Remoting: Test-PsRemoting</a>: "<br /><br />When you’re writing a script that depends on PowerShell Remoting, it’s often helpful<br />to know that the remoting channel is open and will support the activities of your<br />script.<br />PowerShell has a Test-WSMan command, but that only verifies that a WSMan connection<br />is possible. There are other scenarios you could be impacted by:<br /><ul><li>Not having permission on the remote machine</li><li>Misconfiguration of the PowerShell endpoint</li><li>Corrupted installation</li><li>(etc)<br /></li></ul>As you dig deeper, you realize that the only way to really test the viability of the<br />remoting channel is to just do something on it, and verify that you got the results<br />you expected to. Since the implementation was so simple, we didn’t write a cmdlet<br />for it. In retrospect, the concept is more difficult than the implementation, so we<br />probably should have written it anyways. Here’s an example function that tests the<br />remoting connection to a specific machine.<br /><blockquote><span style="color: darkblue; font-family: consolas; font-size: 10pt;">function</span><span style="color: black; font-family: consolas; font-size: 10pt;"> </span><span style="color: blueviolet; font-family: consolas; font-size: 10pt;">Test-PsRemoting</span><span style="font-family: consolas; font-size: 10pt;"><span style="color: black;">{</span><br />&nbsp; <span style="color: darkblue;">param</span><span style="color: black;">(</span><br />&nbsp;&nbsp; <span style="color: darkgrey;">[</span><span style="color: lightblue;">Parameter</span><span style="color: black;">(Mandatory </span><span style="color: darkgrey;">=</span><span style="color: black;"> </span><span style="color: orangered;">$true</span><span style="color: black;">)</span><span style="color: darkgrey;">]</span><br />&nbsp;&nbsp; <span style="color: orangered;">$computername</span><br />&nbsp; <span style="color: black;">)</span><br />&nbsp; <span style="color: darkblue;">try</span><span style="color: black;">{</span><br />&nbsp;&nbsp; <span style="color: orangered;">$errorActionPreference</span><span style="color: black;"> </span><span style="color: darkgrey;">=</span><span style="color: black;"> </span><span style="color: darkred;">"Stop"</span><br />&nbsp;&nbsp; <span style="color: black;">        </span><span style="color: orangered;">$result</span><span style="color: black;"> </span><span style="color: darkgrey;">=</span><span style="color: black;"> </span><span style="color: blue;">Invoke-Command</span><span style="color: black;"> </span><span style="color: navy;">-ComputerName</span><span style="color: black;"> </span><span style="color: orangered;">$computername</span><span style="color: black;"> { </span><span style="color: purple;">1</span><span style="color: black;"> }</span><br />&nbsp; <span style="color: black;">}</span><br />&nbsp; <span style="color: darkblue;">catch</span><span style="color: black;">{</span><br />&nbsp;&nbsp; <span style="color: blue;">Write-Verbose</span><span style="color: black;"> </span><span style="color: orangered;">$_</span><br />&nbsp;&nbsp; <span style="color: darkblue;">return</span><span style="color: black;"> </span><span style="color: orangered;">$false</span><br />&nbsp; <span style="color: black;">}</span><br />&nbsp; <span style="color: darkgreen;">##I've never seen this happen, but if you want to be</span><br />&nbsp; <span style="color: darkgreen;">##thorough....</span><br />&nbsp; <span style="color: darkblue;">if</span><span style="color: black;">(</span><span style="color: orangered;">$result</span><span style="color: black;"> </span><span style="color: darkgrey;">-ne</span><span style="color: black;"> </span><span style="color: purple;">1</span><span style="color: black;">)</span><span style="color: black;">{</span><br />&nbsp;&nbsp; <span style="color: blue;">Write-Verbose</span><span style="color: black;"> </span><span style="color: darkred;">"Remoting to $computerName returned an unexpected result."</span><br />&nbsp;&nbsp; <span style="color: darkblue;">return</span><span style="color: black;"> </span><span style="color: orangered;">$false</span><br />&nbsp; <span style="color: black;">}</span><br />&nbsp; <span style="color: orangered;">$true</span><span style="color: black;">    </span><br /><span style="color: black;">}</span></span><br /></blockquote>
