+++
title = "PowerShell Object Creation – New-Module Pt. 1"
date = 2014-05-20T18:20:00Z
updated = 2014-05-22T18:55:28Z
tags = ["Objects", "Powershell"]
blogimport = true 
[author]
	name = "Paul Cassidy"
	uri = "https://plus.google.com/112112394037667071918"
+++

<br />I have seen quite a few posts on creating custom objects in PowerShell, comparing it to techniques used in languages such as JavaScript but most use some variation of defining an object literal using Select-Object, New-Object, or a HashTable that is cast to PSCustomObject which are all fine and great ways of creating a one off Property Bag. These posts seem skip the most powerful way to define objects in PowerShell and that is to use the New-Module Cmdlet. The New-Module Cmdlet has a switch –AsCustomObject and a parameter –ScriptBlock that allow you to define a custom object. Inside the ScriptBlock every Variable defined is a property and you control whether it’s public or private by using the Export-ModuleMember Cmdlet if you export a variable it is public otherwise it is private. The most powerful part comes in the form that your functions defined inside the module ScriptBlock become the methods and the parameters define the methods arguments for the object and again the visibility is controlled by the Export-ModuleMember Cmdlet. The Functions can be Advanced Functions with Parameter Validation and Comment Based Help. Lets look at some code.<br /><br /><script src="http://pastebin.com/embed_js.php?i=1HFDnMVq"></script><br /><br />Running this code will provide us with a local variable $BlogPostInfo that we can inspect. <br /><br /><br /><br /><a href="http://lh6.ggpht.com/-DkjLrcN6r6g/U3v_dNXe-JI/AAAAAAAAELE/_YlnCyIBj5c/s1600-h/Example.001%25255B3%25255D.jpg"><img alt="Example.001" border="0" src="http://lh3.ggpht.com/-1t3W2D5Av8w/U3v_d1Esh0I/AAAAAAAAELM/8KJVXnZILTE/Example.001_thumb%25255B1%25255D.jpg?imgmax=800" height="323" style="border-bottom-width: 0px; border-left-width: 0px; border-right-width: 0px; border-top-width: 0px; display: inline;" title="Example.001" width="744" /></a><br /><br /><br />We can see that the variable has the PSCustomObject type and are variable are now NoteProperties and our function is now a ScriptMethod. Also notice that our IsPublished variable is not included in the list because it is private, we did not export it. Next time we will cover some advanced topics such as defining ScriptProperties and method overriding.<br /><br /><br />$Until_Then = Good-Times | Get-Command
